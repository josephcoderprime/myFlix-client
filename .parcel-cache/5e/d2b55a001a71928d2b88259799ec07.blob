var helpers = require("../../../node_modules/@parcel/transformer-react-refresh-wrap/lib/helpers/helpers.js");
var prevRefreshReg = window.$RefreshReg$;
var prevRefreshSig = window.$RefreshSig$;
helpers.prelude(module);

try {
var parcelHelpers = require("@parcel/transformer-js/src/esmodule-helpers.js");
parcelHelpers.defineInteropFlag(exports);
parcelHelpers.export(exports, "ProfileView", ()=>ProfileView
);
var _react = require("react");
var _reactDefault = parcelHelpers.interopDefault(_react);
var _button = require("react-bootstrap/Button");
var _buttonDefault = parcelHelpers.interopDefault(_button);
var _axios = require("axios");
var _axiosDefault = parcelHelpers.interopDefault(_axios);
var _form = require("react-bootstrap/Form");
var _formDefault = parcelHelpers.interopDefault(_form);
var _reactRouterDom = require("react-router-dom");
var _card = require("react-bootstrap/Card");
var _cardDefault = parcelHelpers.interopDefault(_card);
var _col = require("react-bootstrap/Col");
var _colDefault = parcelHelpers.interopDefault(_col);
var _config = require("../../config");
var _configDefault = parcelHelpers.interopDefault(_config);
class ProfileView extends _reactDefault.default.Component {
    constructor(){
        super();
        this.state = {
            username: "",
            email: "",
            birthday: "",
            favoriteMovies: [],
            movies: ""
        };
    }
    componentDidMount() {
        this.getUser();
    }
    getUser() {
        this.setState({
            username: localStorage.getItem("user"),
            email: localStorage.getItem("email"),
            birthday: localStorage.getItem('birthday'),
            favoriteMovies: localStorage.getItem("favoriteMovies")
        });
    }
    removeFavorite(movie) {
        let username = localStorage.getItem('user');
        let token = localStorage.getItem("token");
        let url = `${_configDefault.default.API_URL}/users/${username}` + localStorage.getItem("user") + "/favourites/" + movie._id;
        _axiosDefault.default.delete(url, {
            headers: {
                Authorization: `Bearer ${token}`
            }
        }).then((response)=>{
            console.log(response);
            let favMovies = response.data.FavoriteMovies;
            localStorage.setItem('favoriteMovies', favMovies);
            this.componentDidMount();
        });
    }
    handleDelete() {
        let token = localStorage.getItem("token");
        let user = localStorage.getItem("user");
        _axiosDefault.default.delete(`${_configDefault.default.API_URL}/users//${user}`, {
            headers: {
                Authorization: `Bearer ${token}`
            }
        }).then(()=>{
            alert(user + " has been deleted");
            localStorage.removeItem("user");
            localStorage.removeItem("token");
            window.location.pathname = "/";
        }).catch(function(error) {
            console.log(error);
        });
    }
    render() {
        const { movies , onBackClick  } = this.props;
        const favoriteMovieList = movies.filter((movies1)=>{
            return this.state.favoriteMovies.includes(movies1._id);
        });
        return(/*#__PURE__*/ _reactDefault.default.createElement("div", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 80
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default, {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 81
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Group, {
            controlId: "formBasicUsername",
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 82
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("h6", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 83
            },
            __self: this
        }, "Username: "), /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Label, {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 84
            },
            __self: this
        }, this.state.username)), /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Group, {
            controlId: "formBasicEmail",
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 86
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("h6", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 87
            },
            __self: this
        }, "Email:"), /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Label, {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 88
            },
            __self: this
        }, this.state.email)), /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Group, {
            controlId: "formBasicDate",
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 90
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("h6", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 91
            },
            __self: this
        }, "Date of Birth:"), /*#__PURE__*/ _reactDefault.default.createElement(_formDefault.default.Label, {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 92
            },
            __self: this
        }, this.state.birthday)), /*#__PURE__*/ _reactDefault.default.createElement(_reactRouterDom.Link, {
            to: `/update/${this.state.username}`,
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 94
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 95
            },
            __self: this
        }, "Edit Profile")), /*#__PURE__*/ _reactDefault.default.createElement("br", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 97
            },
            __self: this
        }), /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
            variant: "warning",
            onClick: ()=>{
                this.handleDelete();
            },
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 98
            },
            __self: this
        }, "Delete Profile"), /*#__PURE__*/ _reactDefault.default.createElement("br", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 99
            },
            __self: this
        }), /*#__PURE__*/ _reactDefault.default.createElement(_cardDefault.default.Subtitle, {
            className: "text-danger",
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 100
            },
            __self: this
        }, "Warning: After deleting the account, you won't be able to recover it!"), /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
            variant: "secondary",
            onClick: ()=>{
                onBackClick();
            },
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 101
            },
            __self: this
        }, "Back"), /*#__PURE__*/ _reactDefault.default.createElement("br", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 102
            },
            __self: this
        })), /*#__PURE__*/ _reactDefault.default.createElement("div", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 104
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("h5", {
            __source: {
                fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                lineNumber: 105
            },
            __self: this
        }, "Favorite Movies:"), favoriteMovieList.map((movies1)=>{
            return(/*#__PURE__*/ _reactDefault.default.createElement(_colDefault.default, {
                md: 3,
                key: movie._id,
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 108
                },
                __self: this
            }, /*#__PURE__*/ _reactDefault.default.createElement(_cardDefault.default, {
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 109
                },
                __self: this
            }, /*#__PURE__*/ _reactDefault.default.createElement(_cardDefault.default.Img, {
                variant: "top",
                src: movies1.ImagePath,
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 110
                },
                __self: this
            }), /*#__PURE__*/ _reactDefault.default.createElement(_cardDefault.default.Body, {
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 111
                },
                __self: this
            }, /*#__PURE__*/ _reactDefault.default.createElement(_reactRouterDom.Link, {
                to: `/movies/${movies1._id}`,
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 112
                },
                __self: this
            }, /*#__PURE__*/ _reactDefault.default.createElement(_cardDefault.default.Title, {
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 113
                },
                __self: this
            }, movies1.Title)))), /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
                onClick: ()=>this.removeFavorite(movie)
                ,
                __source: {
                    fileName: "C:\\Users\\Beppe\\Documents\\careerfoundry\\myFlix-client\\src\\components\\profile-view\\profile-view.jsx",
                    lineNumber: 117
                },
                __self: this
            }, "Remove")));
        }))));
    }
}

  helpers.postlude(module);
} finally {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}